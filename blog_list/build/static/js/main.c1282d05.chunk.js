(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{24:function(e,t,n){},45:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n(18),s=n.n(a),c=(n(24),n(19)),i=n(2),u=n.n(i),o=n(5),l=n(3),d=n(0),b=function(e){var t=e.buttonLabelWhenHidden,n=e.buttonLabelWhenShown,a=e.children,s=e.blog,c=Object(r.useState)(!1),i=Object(l.a)(c,2),u=i[0],o=i[1],b={display:u?"none":""},j={display:u?"":"none"},h=function(){o(!u)};return Object(d.jsxs)("div",{children:[Object(d.jsxs)("div",{style:b,"data-testid":"hidden",className:"hidden",children:[s.title," ",s.author,Object(d.jsx)("button",{onClick:h,children:t})]}),Object(d.jsxs)("div",{style:j,"data-testid":"shown",className:"shown",children:[s.title," ",s.author,Object(d.jsx)("button",{onClick:h,children:n}),a]})]})},j=function(e){var t=e.blog,n=e.user,r=e.likeBlog,a=e.deleteBlog,s=t.user?t.user.userName:null,c=function(){a(t)};return Object(d.jsx)("div",{style:{paddingTop:10,paddingLeft:2,border:"solid",borderWidth:1,marginBottom:5},className:"blog",children:Object(d.jsx)(b,{blog:t,buttonLabelWhenHidden:"show details",buttonLabelWhenShown:"hide details",children:Object(d.jsxs)("div",{children:[Object(d.jsx)("div",{children:t.url}),Object(d.jsxs)("div",{id:"blog-likes",children:[t.likes,Object(d.jsx)("button",{id:"like-button",onClick:function(){var e=t.id,n={title:t.title,author:t.author,url:t.url,likes:t.likes+1};r(e,n)},children:"like"})]}),Object(d.jsx)("div",{children:s}),t.user&&t.user.userName===n.userName?Object(d.jsx)("button",{onClick:c,children:"delete"}):null]})})})},h=n(6),f=n.n(h),p="/api/blogs",O=null,g={getAll:function(){return f.a.get(p).then((function(e){return e.data}))},create:function(){var e=Object(o.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:O}},e.next=3,f.a.post(p,t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),setToken:function(e){O="bearer ".concat(e)},update:function(){var e=Object(o.a)(u.a.mark((function e(t,n){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.put("".concat(p,"/").concat(t),n);case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),deleteBlog:function(){var e=Object(o.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:O}},r=f.a.delete("".concat(p,"/").concat(t),n),e.abrupt("return",r.data);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},v={login:function(){var e=Object(o.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.post("/api/login",t);case 2:return n=e.sent,console.log(n.data),e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},x=function(e){var t=e.userName,n=e.password,r=e.setUserName,a=e.setPassword,s=e.setUser,c=e.setMessage,i=e.setMessageClass,l=function(){var e=Object(o.a)(u.a.mark((function e(o){var l;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o.preventDefault(),e.prev=1,e.next=4,v.login({userName:t,password:n});case 4:l=e.sent,window.localStorage.setItem("loggedInUser",JSON.stringify(l)),g.setToken(l.token),s(l),r(""),a(""),e.next=17;break;case 12:e.prev=12,e.t0=e.catch(1),i("error"),c("Invalid Username or Password"),setTimeout((function(){c(null)}),5e3);case 17:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}();return Object(d.jsxs)("form",{onSubmit:l,children:[Object(d.jsx)("h2",{children:"Log in"}),Object(d.jsxs)("div",{children:["username:",Object(d.jsx)("input",{id:"username",type:"text",value:t,name:"Username",onChange:function(e){var t=e.target;return r(t.value)}})]}),Object(d.jsxs)("div",{children:["password:",Object(d.jsx)("input",{id:"password",type:"password",value:n,name:"Password",onChange:function(e){var t=e.target;return a(t.value)}})]}),Object(d.jsx)("button",{type:"submit",id:"login-button",children:"login"})]})},m=function(e){var t=e.setMessage,n=e.setMessageClass,a=e.addBlog,s=Object(r.useState)(""),c=Object(l.a)(s,2),i=c[0],u=c[1],o=Object(r.useState)(""),b=Object(l.a)(o,2),j=b[0],h=b[1],f=Object(r.useState)(""),p=Object(l.a)(f,2),O=p[0],g=p[1];return Object(d.jsxs)("form",{onSubmit:function(e){e.preventDefault();var r={title:i,author:j,url:O};""===r.title||""===r.url?(n("error"),t("Title and URL are required fields"),setTimeout((function(){t(null)}),5e3)):function(e){a(e),u(""),h(""),g("")}(r)},children:[Object(d.jsx)("h2",{children:"Create New Blog"}),Object(d.jsxs)("div",{children:["Title:",Object(d.jsx)("input",{id:"title",type:"text",value:i,name:"title",onChange:function(e){var t=e.target;return u(t.value)}})]}),Object(d.jsxs)("div",{children:["Author:",Object(d.jsx)("input",{id:"author",type:"text",value:j,name:"author",onChange:function(e){var t=e.target;return h(t.value)}})]}),Object(d.jsxs)("div",{children:["URL:",Object(d.jsx)("input",{id:"url",type:"text",value:O,name:"url",onChange:function(e){var t=e.target;return g(t.value)}})]}),Object(d.jsx)("button",{id:"blog-submit-button",type:"submit",children:"Add new"})]})},w=function(e){var t=e.message,n=e.messageClass;return null===t?null:Object(d.jsx)("div",{className:n,children:t})},k=Object(r.forwardRef)((function(e,t){var n=e.buttonLabelWhenHidden,a=e.buttonLabelWhenShown,s=e.children,c=Object(r.useState)(!1),i=Object(l.a)(c,2),u=i[0],o=i[1],b={display:u?"none":""},j={display:u?"":"none"},h=function(){o(!u)};return Object(r.useImperativeHandle)(t,(function(){return{toggleVisibility:h}})),Object(d.jsxs)("div",{children:[Object(d.jsx)("div",{style:b,children:Object(d.jsx)("button",{onClick:h,children:n})}),Object(d.jsxs)("div",{style:j,children:[s,Object(d.jsx)("button",{onClick:h,children:a})]})]})})),y=function(){var e=Object(r.useState)([]),t=Object(l.a)(e,2),n=t[0],a=t[1],s=Object(r.useState)(""),i=Object(l.a)(s,2),b=i[0],h=i[1],f=Object(r.useState)(""),p=Object(l.a)(f,2),O=p[0],v=p[1],y=Object(r.useState)(null),S=Object(l.a)(y,2),C=S[0],N=S[1],L=Object(r.useState)(null),B=Object(l.a)(L,2),W=B[0],T=B[1],U=Object(r.useState)("added"),M=Object(l.a)(U,2),A=M[0],I=M[1],H=Object(r.useState)(!1),E=Object(l.a)(H,2),J=E[0],P=E[1];Object(r.useEffect)((function(){g.getAll().then((function(e){return a(e)}))}),[]),Object(r.useEffect)((function(){var e=window.localStorage.getItem("loggedInUser");if(e){var t=JSON.parse(e);N(t),g.setToken(t.token)}}),[]);var R=Object(r.useRef)(),D=function(){var e=Object(o.a)(u.a.mark((function e(t,r){var s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.update(t,r);case 2:s=e.sent,a(n.map((function(e){return e.id!==t?e:s})));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),z=function(){var e=Object(o.a)(u.a.mark((function e(t){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm('Delete "'.concat(t.title,'"?'))){e.next=5;break}return r=t.id,e.next=4,g.deleteBlog(r);case 4:a(n.filter((function(e){return e.id!==r})));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),V=function(){var e=Object(o.a)(u.a.mark((function e(t){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,R.current.toggleVisibility(),e.next=4,g.create(t);case 4:r=e.sent,a(n.concat(r)),I("added"),T('"'.concat(t.title,'" was added')),setTimeout((function(){T(null)}),5e3),e.next=17;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0.response.data),I("error"),T("Error- couldn't add new blog"),setTimeout((function(){T(null)}),5e3);case 17:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}(),q=J?Object(c.a)(n).sort((function(e,t){return t.likes-e.likes})):n;return null===C?Object(d.jsxs)("div",{children:[Object(d.jsx)("h1",{children:"Blogs"}),Object(d.jsx)(w,{message:W,messageClass:A}),Object(d.jsx)(k,{buttonLabelWhenHidden:"Login",buttonLabelWhenShown:"cancel",children:Object(d.jsx)(x,{userName:b,password:O,user:C,setUserName:h,setPassword:v,setUser:N,setMessage:T,setMessageClass:I})})]}):Object(d.jsxs)("div",{children:[Object(d.jsx)("h1",{children:"Blogs"}),Object(d.jsxs)("h2",{children:[C.userName," is logged in",Object(d.jsx)("button",{onClick:function(){window.localStorage.clear(),N(null),h(""),v("")},children:"logout"})]}),Object(d.jsx)(w,{message:W,messageClass:A}),Object(d.jsx)(k,{buttonLabelWhenHidden:"Add new blog",buttonLabelWhenShown:"cancel",ref:R,children:Object(d.jsx)(m,{setMessage:T,setMessageClass:I,addBlog:V})}),Object(d.jsxs)("div",{children:["sort by:",Object(d.jsx)("button",{onClick:function(){return P(!1)},children:"age"}),Object(d.jsx)("button",{onClick:function(){return P(!0)},children:"likes"})]}),q.map((function(e){return Object(d.jsx)(j,{blog:e,user:C,likeBlog:D,deleteBlog:z},e.id)}))]})};s.a.render(Object(d.jsx)(y,{}),document.getElementById("root"))}},[[45,1,2]]]);
//# sourceMappingURL=main.c1282d05.chunk.js.map